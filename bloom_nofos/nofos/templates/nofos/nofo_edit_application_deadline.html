{% extends 'base.html' %}
{% load nofo_name %}

{% block title %}
  NOFO Application Deadline
{% endblock %}

{% block body_class %}edit__application-deadline{% endblock %}

{% block content %}
  {% with nofo|nofo_name as nofo_name_str %}
  {% with "Back to  “"|add:nofo_name_str|add:"”" as back_text %}
    {% url 'nofos:nofo_edit' nofo.id as back_href %}
    {% include "includes/page_heading.html" with title="NOFO Application Deadline" back_text=back_text back_href=back_href only %}
  {% endwith %}
  {% endwith %}

  <form id="nofo-application-deadline--form" method="post">
    {% csrf_token %}

    {% include "includes/form_macro.html" with hint2="eg: “Monday, January 1, 2024”" %}

    <button class="usa-button margin-top-3" type="submit">Save application deadline</button>

  {% if subsection_matches %}
    <hr class="margin-top-4 margin-bottom-3">
    <table class="usa-table usa-table--borderless">
      <caption>
        <h2 class="h4">{{ subsection_matches|length }} subsection{{ subsection_matches|length|pluralize }} found with “{{ form.application_deadline.value }}”</h2>
      </caption>
      <thead>
        <tr class="usa-sr-only">
          <th scope="col">Replace?</th>
          <th scope="col">Section</th>
          <th scope="col">Subsection</th>
          <th scope="col">Content</th>
        </tr>
      </thead>
      <tbody>
        {% for match in subsection_matches %}
        <tr>
          <td>
            <div class="usa-checkbox">
              <input
                class="usa-checkbox__input"
                id="replace-{{ match.subsection_id }}"
                type="checkbox"
                name="replace_subsections"
                value="{{ match.subsection_id }}"
              />
              <label class="usa-checkbox__label" for="replace-{{ match.subsection_id }}">
                <span class="usa-sr-only">Replace application deadline in subsection: {{ match.subsection_name }}</span>
              </label>
            </div>
          </td>
          <th scope="row">{{ match.section.name }}</th>
          <td>
            <a class="usa-link usa-link--external" href="{% url "nofos:subsection_edit" nofo.id match.section.id match.subsection_id %}">
              {{ match.subsection_name }}
            </a>
          </td>
          <td>
            {{ match.highlighted_body|safe|linebreaksbr }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}
  </form>
{% endblock %}
